<script>
    const totalImages = 19; // שיניתי ל-19 כי זה מה שיש לך בתיקייה
    const container = document.getElementById('slideshow');
    const extensions = ['jpg', 'JPG', 'png', 'PNG', 'jpeg'];
    let processedCount = 0;
    const finalImages = [];

    function init() {
        for (let i = 0; i <= totalImages; i++) {
            tryLoad(i, 0);
        }
    }

    function tryLoad(index, extIndex) {
        if (extIndex >= extensions.length) {
            processedCount++;
            updateStatus();
            return;
        }

        const img = new Image();
        img.onload = function() {
            finalImages[index] = img.src;
            processedCount++;
            updateStatus();
        };
        img.onerror = function() {
            tryLoad(index, extIndex + 1);
        };
        img.src = `${index}.${extensions[extIndex]}`;
    }

    function updateStatus() {
        document.getElementById('status').innerText = `מעבד רגעים... (${processedCount}/${totalImages + 1})`;
        if (processedCount > totalImages) build();
    }

    function build() {
        finalImages.forEach(src => {
            if (src) {
                let div = document.createElement('div');
                div.className = 'mySlides fade';
                let slideImg = document.createElement('img');
                slideImg.src = src;
                div.appendChild(slideImg);
                container.appendChild(div);
            }
        });
        document.getElementById('status').style.display = 'none';
        document.getElementById('btn').style.display = 'block';
    }

    function startExperience() {
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
        document.getElementById('bgMusic').play();
        showSlides();
    }

    let slideIndex = 0;
    function showSlides() {
        let slides = document.getElementsByClassName("mySlides");
        if (slides.length === 0) return;
        for (let i = 0; i < slides.length; i++) slides[i].style.display = "none";
        slideIndex++;
        if (slideIndex > slides.length) slideIndex = 1;
        slides[slideIndex-1].style.display = "block";
        setTimeout(showSlides, slideIndex === 1 ? 8000 : 4000);
    }
    init();
</script>
